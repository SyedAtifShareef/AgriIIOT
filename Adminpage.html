<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
      
      
</head>
<body>
    <div class="container">
        <div class="row justify-content-center">
          <div class="col-md-8 rounded shadow p-4 bg-white">
            <div class="d-flex flex-column align-items-center mb-4 h1wrapper">
              <h1 class="h1 heading">Agri IIOT Admin Dashboard</h1>
            </div>
            <div class="row">
              <div class="col-sm-6 mb-3">
                <div class="card border border-light rounded shadow p-3">
                  <h2>Temperature</h2>
                  <p class="h5 text-center" id="temperature">22 &#8451;</p>
                </div>
              </div>
              <div class="col-sm-6 mb-3">
                <div class="card border border-light rounded shadow p-3">
                  <h2>Humidity</h2>
                  <p class="h5 text-center" id="humidity">10%</p>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-6 mb-3">
                <div class="card border border-light rounded shadow p-3">
                  <h2>LightBrightness</h2>
                  <p class="h5 text-center" id="LightBrightness">10</p>
                </div>
              </div>
              <div class="col-sm-6 mb-3">
                <div class="card border border-light rounded shadow p-3">
                  <h2>SoilStatus</h2>
                  <p class="h5 text-center" id="SoilMoistureStatus">"Dr"</p>
                </div>
              </div>
            </div>
            <div class="row justify-content-center">
                
              <div class="col-md-6 mb-3 text-center">
                <h1 class="h4">Water Pump Control</h1>
                
                <div class="btn-group w-100" role="group" aria-label="Water Pump Control">
                  <button type="button" id="autoButton" class="btn btn-success mx-1">Set to AUTO</button>
                  <button type="button" id="onButton" class="btn btn-primary mx-1">Set to ON</button>
                  <button type="button" id="offButton" class="btn btn-danger mx-1">Set to OFF</button>
                </div>
              </div>
            </div>
            <div class="row justify-content-center">  <div class="col-md-6 mb-3 text-center">  <h1 class="h4">Set Minimum Brightness Trigger</h1>
                <form id="brightnessForm">
                  <div class="form-group">
                    <label for="brightnessInput">Brightness (0-100):</label>
                    <input type="number" class="form-control" id="brightnessInput" name="brightness" min="0" max="100" required>
                  </div>
                  <button type="submit" class="btn btn-primary sb1">Submit</button>
                </form>
              </div>
            </div>
            <div class="row justify-content-center">  <div class="col-md-6 mb-3 text-center">  <h1 class="h4">Set Humidifier Range</h1>
                <form id="rangeForm">
                  <div class="form-group">
                    <label for="humidityLowerLimit">Lower Limit (0-100):</label>
                    <input type="number" class="form-control" id="humidityLowerLimit" name="lower" step="0.01" min="0" max="100" required>
                  </div>
                  <div class="form-group">
                    <label for="humidityUpperLimit">Upper Limit (0-100):</label>
                    <input type="number" class="form-control" id="humidityUpperLimit" name="upper" step="0.01" min="0" max="100" required>
                  </div>
                  <button type="submit" class="btn btn-primary sb2">Submit</button>
                </form>
              </div>
            </div> 
            <footer class="footer mt-auto py-3 bg-light text-center">
                <div class="container">
                    <span class="text-muted">&copy; 2024 Agriculture IIOTâ„¢. All rights reserved.</span>
                </div>
            </footer>


<!-- the scripts for products you want to access must be added-->

<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>

<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>


<script type="module">
// Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-analytics.js";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
apiKey: "AIzaSyDlsov3LNCBgTA4jbBM3827Ft5xG66mOSo",
authDomain: "agri-iiot.firebaseapp.com",
databaseURL: "https://agri-iiot-default-rtdb.asia-southeast1.firebasedatabase.app",
projectId: "agri-iiot",
storageBucket: "agri-iiot.appspot.com",
messagingSenderId: "657924866063",
appId: "1:657924866063:web:969e9e38cca0bfcd85637a",
measurementId: "G-E1Q9TJSWL8"
};

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);


  // getting reference to the database
  var database = firebase.database();

  //getting reference to the data we want
  var dataRef1 = database.ref('/Sensor/Humidity');
  var dataRef2 = database.ref('/Sensor/Temperature');
  var dataRef3 = database.ref('/Sensor/LightBrightness');
  var dataRef4 = database.ref('/Sensor/SoilMoistureStatus');

  //fetch the data
  dataRef1.on('value', function(getdata1){
      var humi = getdata1.val();
    console.log(humi)
      document.getElementById('humidity').innerHTML = humi + "%";
  })

   dataRef2.on('value', function(getdata2){
      var temp = getdata2.val();
      console.log(temp)
      document.getElementById('temperature').innerHTML = temp + "&#8451;";
  })

   dataRef3.on('value', function(getdata3){
      var lightBrightness = getdata3.val();
      console.log(lightBrightness)
      document.getElementById('LightBrightness').innerHTML = lightBrightness + "%";
  })

   dataRef4.on('value', function(getdata4){
      var soilMoistureStatus = getdata4.val();
      console.log(soilMoistureStatus)
      document.getElementById('SoilMoistureStatus').innerHTML = soilMoistureStatus;
  })


//   updating the values 
// Reference to the water pump status in the database
const waterPumpStatusRef = firebase.database().ref("/Actuators/WaterPump/waterPumpStatus");

// Function to update the water pump status
function updateWaterPumpStatus(status) {
waterPumpStatusRef.set(status)
    .then(() => {
        console.log("Water pump status updated to:", status);
    })
    .catch((error) => {
        console.error("Error updating water pump status:", error);
    });
}

// Event listeners for buttons
document.getElementById("autoButton").addEventListener("click", () => {
updateWaterPumpStatus("AUTO");
});

document.getElementById("onButton").addEventListener("click", () => {
updateWaterPumpStatus("ON");
});

document.getElementById("offButton").addEventListener("click", () => {
updateWaterPumpStatus("OFF");
});
// Reference to the minimum brightness trigger in the database
const minBrightnessTriggerRef = firebase.database().ref("/Actuators/ExternalLight/minBrightnessTrigger");

// Function to update the minimum brightness trigger
function updateMinBrightnessTrigger(value) {
minBrightnessTriggerRef.set(value)
    .then(() => {
        console.log("Minimum brightness trigger updated to:", value);
    })
    .catch((error) => {
        console.error("Error updating minimum brightness trigger:", error);
    });
}

// Handle form submission
document.getElementById("brightnessForm").addEventListener("submit", function(event) {
event.preventDefault();
const brightnessValue = parseInt(document.getElementById("brightnessInput").value, 10);

if (brightnessValue >= 0 && brightnessValue <= 100) {
    updateMinBrightnessTrigger(brightnessValue);
} else {
    alert("Please enter a value between 0 and 100.");
}
});


const huLowerRef = firebase.database().ref("/Actuators/humidifier/huLower");
const huUpperRef = firebase.database().ref("/Actuators/humidifier/huUpper");

// Function to update the humidifier range in the database
function updateHumidifierRange(lower, upper) {
huLowerRef.set(lower)
    .then(() => {
        console.log("Lower limit updated to:", lower);
    })
    .catch((error) => {
        console.error("Error updating lower limit:", error);
    });

huUpperRef.set(upper)
    .then(() => {
        console.log("Upper limit updated to:", upper);
    })
    .catch((error) => {
        console.error("Error updating upper limit:", error);
    });
}

// Handle form submission
document.getElementById("rangeForm").addEventListener("submit", function(event) {
event.preventDefault();
let lowerValue = parseFloat(document.getElementById("humidityLowerLimit").value);
let upperValue = parseFloat(document.getElementById("humidityUpperLimit").value);

// Validate input values
if (lowerValue >= 0 && lowerValue <= 100 && upperValue >= 0 && upperValue <= 100) {
    if (lowerValue <= upperValue) {
        updateHumidifierRange(lowerValue, upperValue);
    } else {
        alert("Lower limit should not be greater than upper limit.");
    }
} else {
    alert("Please enter values between 0 and 100.");
}
});





</script>
</body>
</html>


